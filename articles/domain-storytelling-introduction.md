---
title: "Domain Storytellingを学ぶ：会話からドメイン知識を可視化する"
emoji: "🗣️"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["domainstorytelling", "ddd", "design", "modeling"]
published: false
---

# はじめに

「業務フローが複雑すぎて、誰も全体像を把握できていない」
「ドキュメントを作ったけれど、エンジニア以外には伝わらない」
「要件定義の段階で認識のズレがあり、手戻りが発生した」

システム開発の現場で、このような課題に直面したことはないでしょうか？
ドメイン知識（業務に関する知識）を、エンジニアだけでなく、ビジネスサイドの担当者（ドメインエキスパート）とも共有し、正しく理解することは、成功するソフトウェア開発の第一歩です。

この記事では、会話を通じてドメイン知識を可視化するモデリング手法「Domain Storytelling（ドメインストーリーテリング）」を紹介します。
難しい記法や UML の知識は必要ありません。ピクトグラムと矢印を使って「物語」を描くだけで、驚くほどスムーズに共通認識を作ることができます。

DDD（ドメイン駆動設計）の文脈でも注目されているこの手法を、基礎から実践方法まで解説します。

# 基礎となる知識

## （そもそも）

### ドメイン知識とは？

ドメイン知識とは、ソフトウェアが解決しようとしている特定の問題領域を理解するための知識です。
例えば、電子商取引システムを開発する場合、注文処理、商品管理、支払い処理など、そのシステムが解決しようとしている問題領域を含む知識がドメイン知識になります。

（画像を追加）

### ドメイン駆動設計（DDD）とは？

ドメイン駆動設計は、ソフトウェア開発において、ドメイン知識を中心に設計を行う手法です。
ドメイン知識を深く理解し、それをモデル化することで、ソフトウェアが実際の業務要件を正確に反映するようにします。

私は以下の記事を参考に学習しました。
https://zenn.dev/yamachan0625/books/ddd-hands-on/viewer/chapter2_what_is_ddd

## Domain Storytelling とは？

Domain Storytelling は、ドメインエキスパートが語る「物語（ストーリー）」を、聞き手がリアルタイムに図式化していくコラボレーション型の手法です。
「ドメイン知識 = 人々の会話の中に存在する」という考えに基づき、具体的な業務シナリオを絵に描くことで、知識を噛み砕き、可視化します。

## なぜ重要なのか？

### 1. 共通言語（ユビキタス言語）の醸成

テキストだけの仕様書は解釈のブレを生みます。また、厳密すぎる UML 図は非エンジニアにとってハードルが高いものです。
Domain Storytelling は、直感的なピクトグラム（アイコン）を使うため、誰でも理解できます。「このアイコンは『お客様』ですね」「この矢印は『注文メールを送る』ということですね」といった会話を通じて、自然とチーム内で言葉の定義が揃っていきます。

### 2. 誤解の早期発見

口頭で説明しているときは「分かったつもり」になりがちです。しかし、目の前で図が描かれていくと、「あれ？ そのタイミングではまだ在庫確認はできないよ」といった指摘が即座に出てきます。フィードバックループを高速に回せるのが大きなメリットです。

## 構成要素（The Pictographic Language）

Domain Storytelling の図（ドメインストーリー）は、以下のシンプルな要素で構成されます。自然言語の「主語・述語・目的語」に対応しています。

- Actors（アクター）: 行動の主体。人、グループ、またはシステム。
  - 例：顧客、店員、会計システム
- Work Objects（ワークオブジェクト）: アクターが操作するもの、情報の入れ物。
  - 例：注文票、チケット、商品、メール
- Activities（アクティビティ）: アクターがワークオブジェクトに対して行う行動。
  - 例：作成する、手渡す、送信する
- Sequence Numbers（順序）: 物語の時系列を示す番号。

# Domain Storytelling の解説や使い方

では、実際にどのように進めるのか、そのステップを解説します。

## 準備するもの

- 参加者: ドメインエキスパート（業務を知っている人）、モデレーター（描く人）、開発者など。
- 道具: ホワイトボードとマーカー、または専用ツール（後述）。

## モデリングのステップ

### 1. シナリオを決める

まずは「何についての物語か」を具体的に決めます。
抽象的な「販売プロセス」ではなく、「A さんが映画のチケットをオンラインで予約し、決済を完了するまで」のように、具体的（Concrete）なシナリオを設定するのがコツです。

### 2. 物語を語ってもらう

ドメインエキスパートに、業務の流れを話してもらいます。
「まず、お客様が映画館のサイトにアクセスして、座席を選びます。すると仮予約状態になって...」

### 3. リアルタイムに描く（Listen & Draw）

モデレーターは、話を聞きながらその場でアイコンを配置し、矢印で繋いでいきます。

- 主語（Actor） → 述語（Activity） → 目的語（Work Object）
- または Actor A → Activity → Work Object → Actor B

例えば、「お客様（Actor）が座席（Object）を選ぶ（Activity）」という会話なら、お客様のアイコンと座席のアイコンを置き、矢印で結んで「選ぶ」と書きます。

### 4. 番号を振る

出来事の順序通りに番号を振ります。これにより、静的な図ではなく「時間の流れ」を持ったストーリーになります。

### 5. 確認と修正（Replay）

描き終わったら、番号順にストーリーを読み上げます。
「1. お客様が座席を選びます。2. システムが空席を確認します...」
ここでエキスパートから「あ、実はその前に会員ログインが必要です」といった指摘が入れば、その場で修正します。

## ツールの紹介

オンラインで実施する場合や、綺麗な図として残したい場合は、専用ツールが便利です。

- [Egon.io (WPS Domain Storytelling Modeler)](https://www.wps.de/modeler/)
  - ブラウザ上で動作する無料の公式ツールです。インストール不要ですぐに使えます。
  - 作成したモデルは画像や JSON 形式でエクスポート可能です。

# やってみた結果

実際に、架空の「映画チケット予約システム」のシナリオを、Egon.io を使ってモデリングしてみました。

## シナリオ：映画のチケット予約

1. 顧客が映画リストから見たい映画を選ぶ。
2. 予約システムが上映スケジュールを提示する。
3. 顧客が座席を選択する。
4. 予約システムが座席を仮押さえする。
5. 顧客がクレジットカード情報を入力する。
6. 予約システムが決済サービスへ支払い要求を送る。
7. 決済サービスが支払い結果を返す。
8. 予約システムが予約確認メールを顧客に送る。

## 気づきと考察

### 「見えないアクター」の発見

最初は「顧客」と「予約システム」だけで完結すると思っていましたが、会話を進めるうちに「決済サービス（外部システム）」という重要なアクターが明確になりました。外部依存がある部分は障害点になりやすいため、設計段階で意識できるのは有益です。

### 順序の重要性

「仮押さえ」のタイミングが決済の前なのか後なのかで、実装難易度が大きく変わります。番号を振って時系列を可視化することで、「決済に失敗したら仮押さえはどうなる？」という異常系の議論（いわゆる Unhappy Path）へスムーズに移行できました。

### 抽象化レベルの調整

最初は「データベースに保存する」といった技術的な詳細を描きそうになりましたが、Domain Storytelling では「ビジネス上の意図」にフォーカスすべきです。「データを INSERT する」ではなく「予約を確定する」と表現することで、非エンジニアとも対話を維持できました。

# まとめ

Domain Storytelling は、複雑な業務要件を解きほぐし、チーム全員の共通理解を作るための強力なツールです。

- 会話を中心にする: 綺麗な図を作ること自体が目的ではなく、会話を通じて理解を深めることが目的です。
- 具体例から入る: 抽象論ではなく、具体的な「誰が、何を、どうする」という物語から始めましょう。
- ピクトグラムでハードルを下げる: 親しみやすいアイコンを使うことで、技術者以外も巻き込みやすくなります。

「要件が複雑で分からない」と感じたら、まずは関係者を集めて、ホワイトボードの前で「物語」を語り合ってみてはいかがでしょうか。

# 参考文献

- 公式サイト: [Domain Storytelling](https://domainstorytelling.org/)
  - 基本的な概念やクイックスタートガイドがあります。
- ツール: [WPS Domain Storytelling Modeler](https://www.wps.de/modeler/)
  - 記事内で紹介したブラウザベースのモデリングツール。
- 書籍: [Domain Storytelling: A Collaborative Modeling Method](https://leanpub.com/domainstorytelling)
  - Stefan Hofer, Henning Schwentner 著。より深く学びたい方向けのバイブルです。
